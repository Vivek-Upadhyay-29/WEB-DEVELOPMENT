Here are your updated, complete scripts to save and load power-ups (like multipliers) just like bricks.


---

✅ Updated SaveData.cs

Now includes:

PowerUpData class

List<PowerUpData> in SaveDataItem

Updated SaveToJson() to include active power-ups


using System;
using System.IO;
using System.Collections.Generic;
using UnityEngine;

public class SaveData : MonoBehaviour
{
    public static SaveData instance;
    public SaveDataItem saveData = new SaveDataItem();

    private string savePath => Application.persistentDataPath + "/saveBrickData.json";

    private void Awake()
    {
        if (instance == null)
        {
            instance = this;
            DontDestroyOnLoad(gameObject);
        }
        else
        {
            Destroy(gameObject);
        }
    }

    public void SaveToJson(int highscore, List<GameObject> bricks)
    {
        saveData.Highscore = highscore;
        saveData.BonusBallCount = ScoreScript.Instance.newBallCountforprefab;
        saveData.CurrentScore = ScoreScript.Instance.GetCurrentScore();
        saveData.bricks = new List<BrickData>();
        saveData.powerUps = new List<PowerUpData>();

        foreach (var obj in bricks)
        {
            if (!obj.activeSelf) continue;

            if (obj.CompareTag("Brick"))
            {
                Brick brickComponent = obj.GetComponent<Brick>();
                if (brickComponent != null)
                {
                    BrickData data = new BrickData
                    {
                        position = obj.transform.position,
                        brickValue = brickComponent.brickValue
                    };
                    saveData.bricks.Add(data);
                }
            }
            else if (obj.CompareTag("PowerUp"))
            {
                PowerUpData data = new PowerUpData
                {
                    position = obj.transform.position,
                    type = obj.name.Replace("(Clone)", "")
                };
                saveData.powerUps.Add(data);
            }
        }

        string json = JsonUtility.ToJson(saveData, true);
        File.WriteAllText(savePath, json);
        Debug.Log("Game Saved");
    }

    public SaveDataItem LoadFromJson()
    {
        if (File.Exists(savePath))
        {
            string json = File.ReadAllText(savePath);
            saveData = JsonUtility.FromJson<SaveDataItem>(json);
            Debug.Log("Game Loaded");
        }
        else
        {
            Debug.Log("Save file not found.");
        }

        return saveData;
    }

    public void DeleteSave()
    {
        if (File.Exists(savePath))
        {
            File.Delete(savePath);
            Debug.Log("Save file deleted");
        }
    }
}

[Serializable]
public class SaveDataItem
{
    public int Highscore;
    public int BallCount;
    public int BonusBallCount;
    public int CurrentScore;
    public List<BrickData> bricks = new List<BrickData>();
    public List<PowerUpData> powerUps = new List<PowerUpData>(); // NEW
}

[Serializable]
public class BrickData
{
    public Vector3 position;
    public int brickValue;
}

[Serializable]
public class PowerUpData
{
    public Vector3 position;
    public string type; // E.g., "Multiplier"
}


---

✅ Updated BrickSpawner.cs

Update the LoadBricksFromSave() method to handle power-up spawning:

public void LoadBricksFromSave()
{
    SaveDataItem data = SaveData.instance.LoadFromJson();

    ScoreScript.Instance.SaveHighScore(data.Highscore);
    ScoreScript.Instance.SetScore(data.CurrentScore);
    ScoreScript.Instance.newBallCountforprefab = data.BonusBallCount;

    foreach (var obj in spawnedBricks)
    {
        if (obj != null)
            Destroy(obj);
    }
    spawnedBricks.Clear();

    foreach (var brickData in data.bricks)
    {
        GameObject brick = Instantiate(brickPrefab, brickData.position, Quaternion.identity);
        brick.tag = "Brick"; // Ensure tag is correct
        Brick brickComponent = brick.GetComponent<Brick>();
        if (brickComponent != null)
        {
            brickComponent.SetValue(brickData.brickValue);
        }
        spawnedBricks.Add(brick);
    }

    foreach (var powerUpData in data.powerUps)
    {
        GameObject powerUp = BrickPool.Instance.GetPooledPowerUp(); // If using pool
        powerUp.transform.position = powerUpData.position;
        powerUp.SetActive(true);
        powerUp.tag = "PowerUp"; // Ensure tag is correct
        spawnedBricks.Add(powerUp);
    }
}


---

✅ Important Notes:

Make sure all your power-up prefabs are tagged as "PowerUp"

You may want to replace BrickPool.Instance.GetPooledPowerUp() with logic to load based on powerUpData.type if you have different types (e.g., Shield, Freeze)

Add similar tag assignment in SpawnBrickRow() for consistency



---

Let me know if you want to support multiple types of power-ups and I'll help you build a PowerUpFactory to select the correct prefab!
