Here's everything you need for full power-up saving and loading:


---

✅ 1. SaveData.cs (Full Updated Script)

using System.Collections.Generic;
using UnityEngine;
using System.IO;

[System.Serializable]
public class BrickData
{
    public Vector3 position;
    public int brickValue;
}

[System.Serializable]
public class PowerUpData
{
    public Vector3 position;
    public string type;
}

[System.Serializable]
public class SaveDataItem
{
    public int Highscore;
    public int CurrentScore;
    public int BonusBallCount;
    public List<BrickData> bricks = new List<BrickData>();
    public List<PowerUpData> powerUps = new List<PowerUpData>();
}

public class SaveData : MonoBehaviour
{
    public static SaveData instance;

    private string saveFilePath;

    private void Awake()
    {
        if (instance == null)
        {
            instance = this;
            saveFilePath = Application.persistentDataPath + "/saveBrickData.json";
        }
        else
        {
            Destroy(gameObject);
        }
    }

    public void SaveToJson(int highScore, List<GameObject> spawnedBricks)
    {
        SaveDataItem data = new SaveDataItem();
        data.Highscore = highScore;
        data.CurrentScore = ScoreScript.Instance.GetCurrentScore();
        data.BonusBallCount = ScoreScript.Instance.newBallCountforprefab;

        foreach (GameObject obj in spawnedBricks)
        {
            if (obj == null || !obj.activeInHierarchy) continue;

            if (obj.CompareTag("Brick"))
            {
                BrickData brickData = new BrickData
                {
                    position = obj.transform.position,
                    brickValue = obj.GetComponent<Brick>().GetValue()
                };
                data.bricks.Add(brickData);
            }
            else if (obj.CompareTag("PowerUp"))
            {
                PowerUpData powerUpData = new PowerUpData
                {
                    position = obj.transform.position,
                    type = obj.name.Replace("(Clone)", "")
                };
                data.powerUps.Add(powerUpData);
            }
        }

        string json = JsonUtility.ToJson(data);
        File.WriteAllText(saveFilePath, json);
        Debug.Log("Game Saved at " + saveFilePath);
    }

    public SaveDataItem LoadFromJson()
    {
        if (File.Exists(saveFilePath))
        {
            string json = File.ReadAllText(saveFilePath);
            return JsonUtility.FromJson<SaveDataItem>(json);
        }
        return new SaveDataItem();
    }
}


---

✅ 2. Modify BrickSpawner.cs → LoadBricksFromSave()

Update your LoadBricksFromSave() like this:

public void LoadBricksFromSave()
{
    SaveDataItem data = SaveData.instance.LoadFromJson();

    ScoreScript.Instance.SaveHighScore(data.Highscore);
    ScoreScript.Instance.SetScore(data.CurrentScore);
    ScoreScript.Instance.newBallCountforprefab = data.BonusBallCount;

    foreach (var obj in spawnedBricks)
    {
        if (obj != null)
            Destroy(obj);
    }
    spawnedBricks.Clear();

    foreach (var brickData in data.bricks)
    {
        GameObject brick = Instantiate(brickPrefab, brickData.position, Quaternion.identity);
        Brick brickComponent = brick.GetComponent<Brick>();
        if (brickComponent != null)
        {
            brickComponent.SetValue(brickData.brickValue);
        }
        spawnedBricks.Add(brick);
    }

    foreach (var powerUpData in data.powerUps)
    {
        GameObject powerUp = BrickPool.Instance.GetPooledPowerUp(); // Or select prefab by type
        powerUp.transform.position = powerUpData.position;
        powerUp.SetActive(true);
        spawnedBricks.Add(powerUp);
    }
}

> If you have different types of power-ups, replace this line:



GameObject powerUp = BrickPool.Instance.GetPooledPowerUp();

With a method like:

GameObject powerUp = PowerUpFactory.GetPowerUp(powerUpData.type);

And create a factory method that returns the correct prefab/pool based on the type.

Power-ups have the tag "PowerUp"

Bricks have the tag "Brick"

You’re using the same spawnedBricks list to hold both (for saving)
